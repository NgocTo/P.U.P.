<html>
<head>
<meta charset="utf-8" />
<title>PUP</title>
<link href="https://fonts.googleapis.com/css?family=Baloo|Merriweather+Sans" rel="stylesheet">
<style>
	body {margin:0px;}
	canvas {width:100%; height:100%}
</style>
<link rel="stylesheet" href="css/master.css">
</head>
<body>
	<div id="intro">
	    <div class="title">P . U . P</div>
		<div>Personal Uplifting Pal</div>
	</div>

	<h3>Frame data:</h3>
	<div id="frameData"></div>
	<div style="clear:both;"></div>
	<h3>Hand data:</h3>
	<div id="handData"></div>
	<div style="clear:both;"></div>
	<h3>Finger data:</h3>
	<div id="pointableData"></div>
	<div style="clear:both;"></div>

<script src="node_modules/leapjs/leap-0.6.4.min.js"></script>
<script src="lib/frame.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/three.js/r73/three.min.js"></script>
<script src="js/orbitControls.js"></script>
<script>

	// SCENE
	var scene = new THREE.Scene();

	// CAMERA
	var camera = new THREE.PerspectiveCamera(500, window.innerWidth / window.innerHeight, 0.1, 1000);
	camera.position.x = 0;
	camera.position.y = 0;
	camera.position.z = 20;
	camera.lookAt(scene.position);

	// RENDERER
	var renderer = new THREE.WebGLRenderer({antialias:true});
	renderer.setSize(window.innerWidth, window.innerHeight);
	document.body.appendChild(renderer.domElement);

	var button; var room;

	//Make Button
	makeButton();
    makeRoom();
	function makeButton() {
		var boxGeom = new THREE.BoxGeometry(30, 8, 1);
		var boxMat = new THREE.MeshPhongMaterial({color: 0xc2f442, transparent: true, opacity: 0.9});
		button = new THREE.Mesh(boxGeom, boxMat);
		scene.add(button);
	}

    function makeRoom() {
        var geometry = new THREE.BoxGeometry(70, 50, 50);
        var roomMaterialArray = [];
        // order to add materials: x+,x-,y+,y-,z+,z-
        roomMaterialArray.push(new THREE.MeshBasicMaterial({color: 0xfaf6eb, side: THREE.DoubleSide}));
        roomMaterialArray.push(new THREE.MeshBasicMaterial({color: 0xfaf6eb, side: THREE.DoubleSide}));
        roomMaterialArray.push(new THREE.MeshBasicMaterial({color: 0xfaf6eb, side: THREE.DoubleSide}));
        roomMaterialArray.push(new THREE.MeshBasicMaterial({color: 0xfaf6eb, side: THREE.DoubleSide}));
        roomMaterialArray.push(new THREE.MeshBasicMaterial({color: 0xfaf6eb, side: THREE.DoubleSide}));
        roomMaterialArray.push(new THREE.MeshBasicMaterial({color: 0xfaf6eb, side: THREE.DoubleSide}));
        var material = new THREE.MeshFaceMaterial(roomMaterialArray);
        var room = new THREE.Mesh(geometry, material);
        scene.add(room);
    }

	// LEAP 
	// Setup Leap loop with frame callback function
	var controllerOptions = {};

	Leap.loop(controllerOptions, function(frame) {
	// Body of callback function
	})

	var frameString = "Frame ID: " + frame.id  + "<br />"
                + "Timestamp: " + frame.timestamp + " &micro;s<br />"
                + "Hands: " + frame.hands.length + "<br />"
                + "Fingers: " + frame.fingers.length + "<br />";

	
		// Display Hand object data
	var handString = "";
	if (frame.hands.length > 0) {
	for (var i = 0; i < frame.hands.length; i++) {
		var hand = frame.hands[i];

		handString += "Hand ID: " + hand.id + "<br />";
		handString += "Direction: " + vectorToString(hand.direction, 2) + "<br />";
		handString += "Palm normal: " + vectorToString(hand.palmNormal, 2) + "<br />";
		handString += "Palm position: " + vectorToString(hand.palmPosition) + " mm<br />";
		handString += "Palm velocity: " + vectorToString(hand.palmVelocity) + " mm/s<br />";
		handString += "Sphere center: " + vectorToString(hand.sphereCenter) + " mm<br />";
		handString += "Sphere radius: " + hand.sphereRadius.toFixed(1) + " mm<br />";

		// And so on...
	}
	}


	// var controller = Leap.loop(function(frame){
	// 	if(frame.hands.length > 0)
	// 	{
	// 		var hand = frame.hands[0];
	// 		var position = hand.palmPosition;
	// 		var velocity = hand.palmVelocity;
	// 		var direction = hand.direction;
	// 	}
	// });

	// // for (var h = 0; h < frame.hands.length; h++){
	// // 	var hand = frame.hands[h];
	// // }
	// // var index = hand.indexFinger;

	// LIGHT
    var directionalLight = new THREE.DirectionalLight( 0xffffff, 0.5 );
	var light = new THREE.AmbientLight(0x404040, 0.1);
	directionalLight.position.set(5, 5, 10);
    scene.add( directionalLight );
	scene.add(light);

	// CONTROLS
	var controls = new THREE.OrbitControls(camera, renderer.domElement);

	// ANIMATION
	function render() {
		// animate mesh or camera (or lights)
		requestAnimationFrame(render);
		renderer.render(scene, camera);
	}
	render();

		// Display Pointable (finger) object data
	var pointableString = "";
	if (frame.pointables.length > 0) {
	for (var i = 0; i < frame.pointables.length; i++) {
		var pointable = frame.pointables[i];

		pointableString += "Pointable ID: " + pointable.id + "<br />";
		pointableString += "Belongs to hand with ID: " + pointable.handId + "<br />";
		pointableString += "Length: " + pointable.length.toFixed(1) + " mm<br />";
		pointableString += "Width: "  + pointable.width.toFixed(1) + " mm<br />";
		pointableString += "Direction: " + vectorToString(pointable.direction, 2) + "<br />";
		pointableString += "Tip position: " + vectorToString(pointable.tipPosition) + " mm<br />";
		pointableString += "Tip velocity: " + vectorToString(pointable.tipVelocity) + " mm/s<br />";
	}
	}

</script>
</body></html>
